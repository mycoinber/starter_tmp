// server/middleware/block-bad-bots.global.ts
export default defineEventHandler((event) => {
  const ua = (getHeader(event, "user-agent") || "").toString();
  // (необязательно) оставим "белый список" системных ботов/превью,
  // чтобы не ломать шаринг/проверки статуса и т.п.
  if (!ua) return;

  // твой перечень паттернов (как есть). Я собрал его в один RegExp.
  // Флаг 'i' — регистронезависимо, '^' в шаблонах сохранены.
  const BLOCK_RE = new RegExp(
    String.raw`^$|^AhrefsSiteAudit.*|^12soso.*|^192.comAgent.*|^1Noonbot.*|^1on1searchBot.*|^3D_SEARCH.*|^3DE_SEARCH2.*|^3GSE.*|^50.nu.*|^A1|^A1|^A6-Indexer.*|^AASP.*|^ABACHOBot.*|^Abonti.*|^abot.*|^AbotEmailSearch.*|^AboutUsBot.*|^AccMonitor|^accoona.*|^AChulkov.NET|^Acme.Spider.*|^AcoonBot.*|^acquia-crawler.*|^ActiveTouristBot.*|^Ad|^AdamM|^adbeat_bot.*|^AdMedia|^adminshop.com.*|^Advanced|^AESOP_com_SpiderMan.*|^AESpider.*|^AF|^aggregator:Vocus.*|^ah-ha.com|^AhrefsBot.*|^AhrefsBot/5.0.*|^AIBOT.*|^aiHitBot.*|^aipbot.*|^AISIID.*|^AITCSRobot/1.1.*|^Akamai-SiteSnapshot.*|^AlexaWebSearchPlatform.*|^AlexfDownload.*|^Alexibot.*|^AlkalineBOT.*|^All|^Alpha|^Amerla|^Amfibibot.*|^AmPmPPC.com.*|^AMZNKAssocBot.*|^Anemone.*|^Anonymous/3G|^Anonymouse.org.*|^AnotherBot.*|^AnswerBot.*|^AnswerBus.*|^AnswerChase|^AntBot.*|^antibot-.*|^AntiSantyWorm.*|^Antro.Net.*|^AONDE-Spider.*|^Apache-HttpClient.*|^Apache-HttpClient/4.0.1|^ApacheBench.*|^Aport.*|^appid:|^Aqua_Products.*|^AraBot.*|^Arachmo.*|^Arachnophilia.*|^archive.org_bot.*|^aria|^arianna.libero.it.*|^Arikus_Spider.*|^Art-Online.com.*|^ArtavisBot.*|^Artera.*|^ASAHA|^ASpider/0.09.*|^ASPSeek.*|^ASPseek.*|^asterias.*|^AstroFind.*|^athenusbot.*|^AtlocalBot.*|^Atomic_Email_Hunter.*|^attach.*|^attrakt.*|^Attributor.comBot.*|^attributor.*|^Attributor/Dejan-.*|^augurfind.*|^AURESYS.*|^AutoBaron|^autoemailspider.*|^autowebdir.*|^AVSearch-.*|^axfeedsbot.*|^Axonize-bot.*|^Ayna.*|^b2w.*|^b2w/0.1.*|^BackDoorBot.*|^BackRub/..*|^BackStreet|^BackWeb.*|^Baiduspider.*|^BaiDuSpider.*|^BaiduSpider.*|^Baiduspider-video.*|^Baiduspider+.*|^Bandit.*|^BatchFTP.*|^baypup.*|^BDFetch.*|^BecomeBot.*|^BecomeJPBot.*|^BeetleBot.*|^Bender.*|^besserscheitern-crawl.*|^betaBot.*|^Big|^Big|^Bigado.com.*|^BigCliqueBot.*|^BigCliqueBOT.*|^Bigfoot.*|^BIGLOTRON.*|^Bilbo.*|^BilgiBetaBot.*|^BilgiBot.*|^bintellibot.*|^bitlybot.*|^BitvoUserAgent.*|^Bizbot003.*|^BizBot04|^BizWorks|^Black|^Black.Hole.*|^Blackbird.*|^BlackMask.Net|^BlackWidow.*|^bladder|^Blaiz-Bee.*|^BLEXBot.*|^Blinkx/DFS-Fetch.*|^BlitzBOT.*|^Blog|^BlogMyWay.*|^BlogPulseLive.*|^BlogRefsBot.*|^BlogScope.*|^Blogslive.*|^BloobyBot.*|^BlowFish.*|^BLT.*|^bnf.fr_bot.*|^BoaConstrictor.*|^BoardReader-Image-Fetcher.*|^BOI_crawl_00.*|^BOIA-Scan-Agent.*|^BOIA.ORG-Scan-Agent.*|^boitho.com-dc.*|^Bookmark|^Bookmark|^bosug.*|^Bot|^Bot.*|^bot.*|^BOT.*|^BotALot.*|^BotRightHere.*|^Botswana.*|^bottybot.*|^BpBot.*|^BRAINTIME_SEARCH.*|^BrokenLinkCheck.com.*|^BrowserEmulator.*|^BrowserMob.*|^BruinBot.*|^BSearchR&D.*|^BSpider.*|^btbot.*|^Btsearch.*|^Buddy.*|^Buibui.*|^BuildCMS|^BuiltBotTough.*|^Bullseye.*|^bumblebee.*|^BunnySlippers.*|^BuscadorClarin.*|^Buscaplus|^Butterfly.*|^BuyHawaiiBot.*|^BuzzBot.*|^byindia.*|^BYINDIA.*|^BySpider.*|^byteserver.*|^bzBot.*|^c|^CacheBlaster.*|^Caddbot.*|^Cafi.*|^Camcrawler.*|^CamelStampede.*|^Canon-WebRecord.*|^Canon-WebRecordPro.*|^CareerBot.*|^cataguru.*|^CatchBot.*|^CazoodleBot.*|^CCBot.*|^CCGCrawl.*|^ccubee.*|^CD-Preload.*|^CE-Preload.*|^Cegbfeieh.*|^Cerberian|^CERT|^cfetch.*|^CFNetwork.*|^Chameleon.*|^Charlotte.*|^Check&Get.*|^Checkbot.*|^CheckLinks.*|^Checklinks.*|^CheeseBot.*|^ChemieDE-NodeBot.*|^CherryPicker.*|^CherryPickerElite.*|^CherryPickerSE.*|^Chilkat.*|^ChinaClaw.*|^CipinetBot.*|^cis455crawler.*|^citeseerxbot.*|^cizilla.com/Cizilla-.*|^ClariaBot.*|^Climate|^ClimateArk|^Clushbot.*|^COAST|^COAST|^coccoc.*|^CollapsarWEB.*|^Collector.*|^Combine.*|^combine.*|^COMBINE.*|^Compatible.*|^ConnectSearch.*|^conpilot.*|^ContentSmartz.*|^ContextAd|^contype.*|^cookieNET.*|^CoolBot|^CoolCheck.*|^Copernic.*|^Copier.*|^CopyRightCheck.*|^core-project.*|^cosmos.*|^Covario-IDS.*|^Cowbot-.*|^Cowdog|^crabbyBot.*|^Crawl_Application.*|^crawl.UserAgent.*|^Crawl.*|^crawl.*|^CrawlConvera.*|^Crawler.*|^crawler.*|^crawler_for_infomine.*|^CRAWLER-ALTSE.VUNET.ORG-Lynx.*|^crawler-upgrade-config.*|^crawler.kpricorn.org.*|^crawler@.*|^crawler43.ejupiter.com.*|^crawler4j.*|^Crawly.*|^CreativeCommons.*|^Crescent.*|^Crescent|^cs-crawler.*|^CSE|^CSHttpClient.*|^Cuasarbot.*|^culsearch/culs.*|^Curl.*|^Custo.*|^cvaulev.*|^Cyberdog.*|^CyberNavi_WebGet.*|^CyberPatrol|^CyberSpyder.*|^CydralSpider.*|^D1GArabicEngine.*|^DA.*|^DataCha0s.*|^DataFountains.*|^DataFountains/DMOZ|^DataparkSearch.*|^datascape|^DataSpearSpiderBot.*|^DataSpider.*|^Dattatec.com.*|^Dattatec.com-Sitios-Top.*|^Daumoa.*|^DAUMOA-video.*|^DAUMOA-web.*|^Declumbot.*|^Deepindex.*|^deepnet|^DeepTrawl.*|^dejan.*|^del.icio.us-thumbnails.*|^DelvuBot.*|^Der|^DiaGem.*|^Diamond.*|^DiamondBot.*|^DiBot.*|^didaxusbot.*|^DigExt.*|^Digger.*|^DiGi-RSSBot.*|^DigitalArchivesBot.*|^DigOut4U.*|^DIIbot.*|^Dillo.*|^Dir_Snatch.exe.*|^DISCo.*|^DISCo|^DISCo|^DISCoFinder.*|^Distilled-Reputation-Monitor.*|^Dit.*|^DittoSpyder.*|^DjangoTraineeBot.*|^DKIMRepBot.*|^DoCoMo.*|^DOF-Verify.*|^Domaincrawler.*|^domaincrawler.*|^DomainScan.*|^DomainWatcher|^DotBot.*|^DotBot/1.1.*|^DotSpotsBot.*|^Dow|^Download.*|^Download|^Download|^Download|^Download|^Download|^Download|^Download|^Downloader.*|^DOY.*|^dragonfly.*|^Drip.*|^drone.*|^Drupal.*|^DTAAgent.*|^dtSearchSpider.*|^dumbot.*|^Dumbot.*|^Dwaar.*|^Dwaarbot.*|^DXSeeker.*|^EAH.*|^Earth|^Earth|^EARTHCOM.info.*|^EARTHCOM.*|^EasyDL.*|^ebingbong.*|^EC2LinkFinder.*|^eCairn-Grabber.*|^eCatch.*|^eCatch/3.0.*|^eChooseBot.*|^EdisterBot|^EduGovSearch.*|^egothor.*|^eidetica.com/spider.*|^EirGrabber.*|^Elblindo|^ElisaBot.*|^EllerdaleBot.*|^EMail|^EmailCollector.*|^EmailLeach.*|^EmailSiphon.*|^EmailWolf.*|^EMPAS_ROBOT.*|^EnaBot.*|^endeca.*|^EnigmaBot.*|^Enswer|^EntityCubeBot.*|^EroCrawler.*|^es.*|^eStyleSearch.*|^eSyndiCat|^Eurosoft-Bot.*|^Evaal.*|^Eventware.*|^Everest-Vulcan|^Exabot.*|^Exabot|^Exabot-Images.*|^Exabot-Test.*|^Exabot-XXX.*|^ExaBotTest.*|^ExactSearch.*|^exactseek.com.*|^exooba/exooba|^Exploder.*|^Express|^Extractor.*|^ExtractorPro.*|^EyeNetIE.*|^ez-robot.*|^Ezooms.*|^f-bot|^factbot.*|^Factbot.*|^FairAd|^falcon.*|^Falconsbot.*|^FAST|^FAST|^fast-search-engine.*|^fastbot|^fastbot.de|^FatBot.*|^Favcollector.*|^Faviconizer.*|^Favorites|^FDM|^FDM|^FDM|^FDSE|^FedContractorBot.*|^fembot.*|^Fetch|^fetch_ici.*|^fgcrawler.*|^Filangy.*|^FileHound.*|^FindAnISP.com_ISP_Finder.*|^findlinks.*|^FindWeb.*|^Firebat.*|^FirstGov.gov|^Flaming|^Flamingo_SearchEngine.*|^FlashCapture.*|^FlashGet.*|^FlashGet|^FlickySearchBot.*|^Fluffy|^flunky.*|^focused_crawler.*|^FollowSite.*|^Foobot.*|^Fooooo_Web_Video_Crawl.*|^Fopper.*|^Forest|^Forest|^Forests.org|^FormulaFinderBot.*|^Forschungsportal.*|^fr_crawler.*|^Francis.*|^FreeWebMonitoring|^FreshDownload.*|^freshlinks.exe.*|^FriendFeedBot.*|^frodo.at.*|^froGgle.*|^FrontPage.*|^FrontPage|^Froola|^FU-NBI/FU-NBI-.*|^full_breadth_crawler.*|^FunnelBack.*|^FurlBot.*|^G10-Bot.*|^Gaisbot.*|^GaisBot.*|^GalaxyBot.*|^gazz.*|^generate_infomine_category_classifiers.*|^genevabot.*|^genieBot.*|^GenieBotRD_SmallCrawl.*|^Genieo.*|^Geomaxenginebot.*|^geometabot.*|^GeonaBot.*|^GeoVisu.*|^GetHTMLContents.*|^Getleft.*|^GetLeft.*|^GetRight.*|^GetRight/2.11.*|^GetRight/3.1.*|^GetRight/3.2.*|^GetRight/3.3.*|^GetRight/3.3.3.*|^GetRight/3.3.4.*|^GetRight/4.0.0.*|^GetRight/4.1.0.*|^GetRight/4.1.1.*|^GetRight/4.1.2.*|^GetRight/4.2.*|^GetRight/4.2b|^GetRight/4.2c.*|^GetRight/4.3.*|^GetRight/4.5.*|^GetRight/4.5a.*|^GetRight/4.5b.*|^GetRight/4.5b1.*|^GetRight/4.5b2.*|^GetRight/4.5b3.*|^GetRight/4.5b6.*|^GetRight/4.5b7.*|^GetRight/4.5c.*|^GetRight/4.5d.*|^GetRight/4.5e.*|^GetRight/5.0beta1.*|^GetRight/5.0beta2.*|^GetSmart.*|^GetURL.rexx|^GetWeb!.*|^Giant.*|^GigablastOpenSource.*|^Gigabot.*|^GigaBot.*|^GigabotSiteSearch.*|^Girafabot.*|^GleameBot.*|^gnome-vfs.*|^Go-Ahead-Got-It.*|^Go!Zilla.*|^GoForIt.com.*|^GOFORITBOT.*|^gold|^Goldfire|^Golem/1.1.*|^GoodJelly.*|^Gordon-College-Google-Mini.*|^goroam.*|^GoSeebot.*|^gotit.*|^Govbot.*|^GPU|^Grabber.*|^GrabNet.*|^Grafula.*|^grapeFX.*|^grapeshot.*|^GrapeshotCrawler/2.0.*|^grbot.*|^GreenYogi|^Gromit.*|^grub.*|^grub|^grub-client.*|^Grub.*|^Grubclient-.*|^GrubNG.*|^GruBot.*|^gsa.*|^gsa-accuracyEval.*|^gsa-crawler.*|^gsa-eusleg.*|^GSLFbot.*|^Gulliver.*|^GulperBot.*|^GurujiBot.*|^GVC|^GVC|^GVC|^GVC|^GVC|^GVC|^gvcbot.com.*|^HappyFunBot.*|^Harvest.*|^Harvest/1.5.*|^HarvestMan.*|^Hatena|^Hawler.*|^hcat.*|^hclsreport-crawler.*|^HD|^Header_Test_Client.*|^healia/healia.*|^Helix.*|^here|^heritrix|^heritrix.*|^Heritrix.*|^heritrix/3.1.0.*|^heritrix/3.1.1.*|^hijbul-heritrix-crawler.*|^HiScan.*|^HiSoftware|^HiSoftware|^hitcrawler_.*|^hivaBot.*|^hloader.*|^HLoader.*|^HMSEbot.*|^HMView.*|^hoge.*|^holmes.*|^HomePageSearch.*|^Hooblybot-Image.*|^HooWWWer.*|^Hostcrawler.*|^HSFT|^HSFT|^HSlide.*|^ht://check.*|^htdig.*|^Html|^HTMLParser.*|^httplib.*|^HTTrack.*|^HTTrack|^HTTrack|^Huaweisymantecspider.*|^hul-wax.*|^humanlinks.*|^HyperEstraier.*|^Hyperix.*|^ia_archiver.*|^IAArchiver-.*|^ibuena.*|^iCab.*|^ICDS-Ingestion.*|^ichiro.*|^iCopyright|^IEAutoDiscovery.*|^IECheck.*|^iHWebChecker.*|^IIITBOT.*|^iim_405.*|^IlseBot.*|^Iltrovatore-Setaccio.*|^IlTrovatore-Setaccio.*|^IlTrovatore.*|^Image|^Image|^ImageBot.*|^imagefortress.*|^ImagesHereImagesThereImagesEverywhere.*|^ImageVisu.*|^imds_monitor.*|^imo-google-robot-intelink.*|^inagist.com|^Industry|^Indy|^Indy|^indylabs_marius.*|^InelaBot.*|^Inet32|^inetbot.*|^info|^InfoLink.*|^infomine.ucr.edu.*|^INFOMINE.*|^InfoNaviRobot.*|^Informant.*|^Infoseek|^InfoSeek|^Infoseek|^InfoTekies.*|^InfoUSABot.*|^INGRID.*|^INGRID/0.1.*|^Inktomi.*|^InsightsCollector.*|^InsightsWorksBot.*|^InspireBot.*|^InsumaScout.*|^Intelix.*|^Intelliseek.*|^InterGET.*|^Internet|^Internet|^Internet|^Internet|^INTERNET|^InternetLinkAgent.*|^Interseek.*|^IOI.*|^ip-web-crawler.com.*|^IPAdd|^IpselonBot.*|^Ipselonbot.*|^Iria.*|^IRLbot.*|^Iron33/1.0.2.*|^Isara/Isara-.*|^iSearch.*|^iSiloX.*|^IstellaBot.*|^its-learning|^IU_CSCI_B659_class_crawler.*|^iVia|^iVia|^iVia.*|^JadynAve.*|^JadynAveBot.*|^Jakarta.*|^Jakarta|^Jbot.*|^JemmaTheTourist.*|^JennyBot.*|^Jetbot.*|^JetBrains|^JetCar.*|^Jim.*|^JoBo.*|^JobSpider_BA.*|^JOC.*|^JOC|^JoeDog.*|^JoyScapeBot.*|^JSpyda.*|^Junut|^JustView.*|^Jyxobot.*|^K.S.Bot.*|^KakcleBot.*|^kalooga.*|^KaloogaBot.*|^KATATUDO-Spider.*|^kbeta1.*|^KeepNI|^Kenjin.Spider.*|^Keybot|^KeywenBot.*|^Keyword|^Keyword.Density.*|^kinjabot.*|^Kitenga-crawler-bot.*|^KiwiStatus.*|^kmbot-.*|^kmccrew|^Knight.*|^KnowItAll.*|^Knowledge|^Knowledge.com.*|^KoepaBot.*|^Koninklijke.*|^KrOWLer.*|^KSbot.*|^kuloko-bot.*|^kulturarw3.*|^KummHttp.*|^Kurzor.*|^Kyluka|^L.webis.*|^Labhoo.*|^labourunions411.*|^Lachesis.*|^lachesis.*|^Lament.*|^LamerExterminator.*|^LapozzBot.*|^larbin.*|^LARBIN-EXPERIMENTAL.*|^LBot.*|^LeapTag.*|^LeechFTP.*|^LeechGet.*|^LetsCrawl.com.*|^LexiBot.*|^LexxeBot.*|^lftp.*|^libcrawl.*|^libiViaCore.*|^libWeb/clsHTTP.*|^libwww-perl.*|^likse.*|^Linguee|^Link|^Link|^link_checker.*|^LinkAlarm.*|^linkbot.*|^Linkbot.*|^LinkCheck|^LinkCheck|^LinkChecker.*|^linkdex.com.*|^LinkextractorPro.*|^LinkLint.*|^linklooker.*|^Linkman.*|^Links|^LinkScan.*|^LinkScan/8.1a.Unix.*|^LinksManager.com_bot.*|^LinkSweeper.*|^LinkWalker.*|^LiteFinder.*|^LitlrBot.*|^Little|^Livelapbot.*|^LM|^LMQueueBot.*|^LNSpiderguy.*|^LoadTimeBot.*|^LocalcomBot.*|^locust.*|^LolongBot.*|^LookBot.*|^Lsearch/sondeur.*|^lssbot.*|^LT|^lwp-request.*|^lwp-trivial.*|^lwp-trivial/1.34.*|^LWP::Simple.*|^LWP/natweb-bad-link-mailer.*|^Lycos_Spider.*|^Lydia|^LynnBot.*|^Lytranslate.*|^Mag-Net.*|^Magnet.*|^magpie-crawler.*|^Magus|^Mail.Ru_Bot.*|^Mail.RU_Bot.*|^Mail.Ru_Bot/2.0.*|^Mail.Ru.*|^Mail.RU.*|^MAINSEEK_BOT.*|^Mammoth.*|^Map|^MarkWatch.*|^MaSagool.*|^masidani_bot_.*|^Mass|^Mass|^Mata|^Mata.Hari.*|^matentzn|^maxamine.com--robot.*|^maxamine.com-robot.*|^maxomobot.*|^McBot.*|^medrabbit.*|^Megite.*|^MemacBot.*|^Memo.*|^MendeleyBot.*|^Mercator-.*|^mercuryboard_user_agent_sql_injection.nasl.*|^metacarta.*|^Metaeuro|^Metager2.*|^metager2-verification-bot.*|^MetaGloss.*|^metal|^metaquerier.cs.uiuc.edu.*|^METASpider.*|^Metaspinner.*|^MetaURI|^MetaURI|^MFcrawler.*|^MFHttpScan.*|^MIDown|^MIIxpc.*|^MIIxpc/4.2.*|^mini-robot.*|^minibot.*|^miniRank.*|^Mirror.*|^Missigua|^Mister|^Mister|^Mister|^Mister.PiX.*|^Miva.*|^MJ12bot.*|^mnoGoSearch.*|^MnoGoSearch.*|^mod_accessibility.*|^moduna.com.*|^moget.*|^moget/2.1.*|^MojeekBot.*|^MonkeyCrawl.*|^MOSES.*|^mowserbot.*|^MQbot.*|^MSE360.*|^MSIndianWebcrawl.*|^MSMOBOT.*|^msnbot-products.*|^MSNPTC.*|^MSRBOT.*|^MT-Soft.*|^MultiText.*|^My_Little_SearchEngine_Project.*|^my-heritrix-crawler.*|^MyApp.*|^MYCOMPANYBOT.*|^mycrawler.*|^MyEngines-US-Bot.*|^MyFamilyBot.*|^Myra.*|^nabot.*|^nabot_.*|^Najdi.si.*|^Nambu.*|^NAMEPROTECT.*|^NASA|^NatchCVS.*|^National|^naver.*|^naverbookmarkcrawler.*|^NaverBot_dloader.*|^NaverBot-.*|^NaverBot.*|^Navroad.*|^NearSite.*|^NEC-MeshExplorer.*|^NeoScioCrawler.*|^NerdByNature.Bot.*|^NerdyBot.*|^Nerima-crawl-.*|^Nessus.*|^NESSUS::SOAP.*|^nestReader.*|^Net|^Net|^Net::Trackback.*|^NetAnts.*|^NetAnts/1.10.*|^NetAnts/1.23.*|^NetAnts/1.24.*|^NetAnts/1.25.*|^NetCarta|^Netcraft.*|^NetID.com|^NetMechanic.*|^Netprospector.*|^NetResearchServer.*|^NetSeer.*|^NetSeer|^NetSeer|^NetShift=.*|^NetSongBot.*|^Netsparker.*|^NetSpider.*|^NetSrcherP.*|^NetZIP.*|^NewMedhunt.*|^news|^News_Search_App.*|^NewsGatherer.*|^Newsgroupreporter.*|^NewsTroveBot.*|^NextGenSearchBot.*|^nextthing.org.*|^NG.*|^nicebot.*|^NICErsPRO.*|^niki-bot.*|^NimbleCrawler.*|^nimbus-1.*|^ninetowns.*|^Ninja.*|^NjuiceBot.*|^NLese.*|^NLESE|^Nogate.*|^Norbert|^NoteworthyBot.*|^NPbot.*|^NPBot.*|^NPBot-.*|^NRCan|^NSDL_Search_Bot.*|^nu_tch-princeton/Nu_tch.*|^nuggetize.com|^nuSearch|^NuSearch|^Nusearch|^Nutch.*|^nutch.*|^nutch1/huntsman.*|^NutchCVS.*|^NutchOrg.*|^NWSpider.*|^Nymesis.*|^nys-crawler.*|^ObjectsSearch.*|^oBot.*|^Obvius|^Ocelli.*|^Octopus.*|^ODP|^oegp|^Offline|^Offline|^Offline|^Offline|^Offline|^Offline|^Offline|^Offline|^Offline|^Offline|^Offline|^Offline|^Offline.Explorer.*|^OGspider.*|^OmiExplorer_Bot.*|^OmniExplorer_Bot.*|^OmniFind.*|^omnifind.*|^OmniWeb.*|^OnetSzukaj.*|^online|^OOZBOT.*|^Openbot.*|^Openfind.*|^Openfind|^OpenIntelligenceData.*|^OpenISearch.*|^OpenLink|^OpenSearchServer_Bot.*|^OpiDig.*|^optidiscover.*|^Oracle|^Oracle|^OrangeBot.*|^ORISBot.*|^ornl_crawler_1.*|^ORNL_Mercury.*|^osis-project.jp.*|^OsO.*|^OutfoxBot.*|^OutfoxMelonBot.*|^OWLER-BOT.*|^owsBot.*|^ozelot.*|^P3P|^page_verifier.*|^PageBitesHyperBot.*|^Pagebull.*|^PageDown.*|^PageFetcher.*|^PageGrabber.*|^PagePeeker.*|^PageRank|^pamsnbot.htm.*|^Panopy|^panscient.com.*|^Pansophica.*|^Papa|^PaperLiBot.*|^PaperLiBot/2.1.*|^parasite.*|^parsijoo.*|^Pathtraq.*|^Pattern.*|^Patwebbot.*|^pavuk.*|^PaxleFramework.*|^PBBOT.*|^pcBrowser.*|^pd-crawler.*|^penthesila.*|^perform_crawl.*|^PerMan.*|^PerMan|^personal|^PHP|^PHPCrawl.*|^PhpDig.*|^PicoSearch.*|^PIENO|^pipBot.*|^pipeLiner.*|^Pita.*|^pixfinder.*|^PiyushBot.*|^plaNETWORK|^Plucker.*|^Plukkie.*|^Plumtree|^Pockey.*|^Pockey-GetHTML.*|^PoCoHTTP.*|^pogodak.ba.*|^Pogodak.co.yu.*|^Poirot.*|^polybot.*|^Pompos.*|^Poodle|^PopScreenBot.*|^PostPost.*|^PrivacyFinder.*|^ProjectWF-java-test-crawler.*|^ProPowerBot/2.14.*|^ProWebWalker.*|^Proxem|^proximic.*|^PROXY|^psbot.*|^PsBot.*|^psbot-page.*|^PSS-Bot.*|^psycheclone.*|^pub-crawler.*|^pucl.*|^pulseBot|^Pump.*|^PWeBot.*|^Python-urllib.*|^pythonic-crawler.*|^PythonWikipediaBot.*|^q1.*|^QEAVis|^QFKBot.*|^qualidade.*|^Qualidator.com|^QuepasaCreep.*|^QueryN|^QueryN.Metasearch.*|^quest.durato.*|^Quintura-Crw.*|^QunarBot.*|^Qweery_robot.txt_CheckBot.*|^QweeryBot.*|^r2iBot.*|^R6_CommentReader.*|^R6_FeedFetcher.*|^R6_VoteReader.*|^RaBot.*|^Radian6.*|^radian6_linkcheck.*|^Radiation|^RAMPyBot.*|^RankurBot/Rankur.*|^Rational|^RcStartBot.*|^RealDownload.*|^RealDownload/4.0.0.40.*|^RealDownload/4.0.0.41.*|^RealDownload/4.0.0.42.*|^Reaper.*|^REBI-Shoveler.*|^REBI-shoveler.*|^Recorder.*|^RedBot.*|^RedCarpet.*|^ReGet.*|^RepoMonkey.*|^RepoMonkey|^research|^Riddler.*|^RIIGHTBOT/RIIGHT-.*|^RiseNetBot.*|^RiverGlassScanner.*|^RiverglassScanner.*|^RMA.*|^RoboPal.*|^Robosourcer.*|^Robot.*|^ROBOT.*|^robot.*|^robotek.*|^robots.*|^Robozilla.*|^rogerBot.*|^Rome|^Rondello.*|^Rotondo.*|^Roverbot.*|^RPT-HTTPClient.*|^rtgibot.*|^RufusBot.*|^Runnk|^Runnk|^s~stremor-crawler.*|^S2Bot.*|^SafariBookmarkChecker.*|^SafetyNet|^SaladSpoon/ShopSalad.*|^Sapienti/Indexer.*|^SBIder.*|^SBL-BOT.*|^SCFCrawler/Nutch-1.8.*|^Scich.*|^ScientificCommons.org.*|^ScollSpider.*|^ScooperBot.*|^Scooter.*|^ScoutJet.*|^ScrapeBox.*|^Scrapy.*|^SCrawlTest.*|^Scrubby.*|^scSpider.*|^Scumbot.*|^Search|^search|^Search-Channel.*|^Search-Engine-Studio.*|^search.KumKie.com.*|^search.msn.com/msnbot.htm.*|^search.updated.com.*|^search.usgs.gov.*|^Searcharoo.NET.*|^SearchBlox.*|^searchbot.*|^SearchBot.*|^searchengine.*|^searchhippo.com.*|^SearchIt-Bot.*|^searchmarking.*|^searchmarks.*|^searchmee_v.*|^Searchmee!|^searchmining.*|^SearchnowBot_v1.*|^searchpreview.*|^SearchSpider.com.*|^SearQuBot/SearQuBot|^SEB|^Seekbot.*|^Seeker.lookseek.com.*|^SeeqBot.*|^seeqpod-vertical-crawler.*|^Selflinkchecker.*|^Semager.*|^semanticdiscovery.*|^Semantifire1.*|^semisearch.*|^SemrushBot.*|^SEOENGWorldBot.*|^SeznamBot.*|^SeznamBot/2.0.*|^SeznamBot/3.2-test1.*|^ShablastBot.*|^ShadowWebAnalyzer.*|^Shareaza.*|^Shelob.*|^sherlock.*|^ShopWiki.*|^ShowLinks.*|^ShowyouBot.*|^siclab.*|^silk.*|^Siphon.*|^SiteArchive.*|^SiteCheck-sitecrawl|^sitecheck.internetseer.com.*|^SiteFinder.*|^SiteGuardBot.*|^SiteOrbiter.*|^SiteSnagger.*|^SiteSucker.*|^SiteSweeper.*|^SiteXpert.*|^SkimBot.*|^SkimWordsBot.*|^SkreemRBot.*|^Skywalker.*|^Sleipnir.*|^slow-crawler.*|^SlySearch.*|^smart-crawler.*|^SmartDownload.*|^SmartDownload/1.2.76|^SmartDownload/1.2.77|^SmartDownload/1.2.77|^SmartDownload/1.2.77|^Smarte|^smartwit.com.*|^Snake.*|^snap.com|^Snapbot.*|^SnapPreviewBot.*|^Snappy.*|^snookit/Snookit.*|^Snooper/b97_01.*|^Snoopy.*|^SocSciBot.*|^SOFT411|^sogou.*|^Sogou.*|^sohu|^sohu-search.*|^Sokitomi|^Solbot/1.0|^sootle.*|^Sosospider.*|^Space|^Space|^SpaceBison.*|^SpankBot.*|^spanner.*|^Spanner/1.0|^Spatineo|^Spatineo|^Spatineo|^special_archiver.*|^Speedy|^SpeedySpider.*|^Sphere|^Sphere|^Sphider.*|^Sphider2.*|^spider.*|^Spider.*|^Spider.TerraNautic.net.*|^SpiderEngine.*|^SpiderKU.*|^SpiderMan.*|^Spinn3r.*|^Spinne.*|^sportcrew-Bot.*|^spyder3.microsys.com.*|^SQ|^sqlmap.*|^Squid-Prefetch.*|^SquidClamAV_Redirector.*|^Sqworm.*|^SrevBot.*|^sslbot.*|^SSM|^StackRambler.*|^StarDownloader.*|^statbot.*|^statcrawler.*|^statedept-crawler.*|^Steeler.*|^STEGMANN-Bot.*|^stero.*|^Stripper.*|^Stumbler.*|^suchclip.*|^Sucker.*|^SumeetBot.*|^SumitBot.*|^SummizeBot.*|^SummizeFeedReader.*|^Sunrise|^SuperBot.*|^superbot.com.*|^SuperBot/3.0|^SuperBot/3.1|^SuperHTTP.*|^SuperLumin|^SuperPagesBot.*|^Supybot.*|^SURF.*|^Surfbot.*|^SurfControl.*|^SurveyBot.*|^suzuran.*|^SWEBot.*|^swish-e.*|^SygolBot.*|^SynapticWalker.*|^Syntryx|^SystemSearch-robot.*|^Szukacz.*|^Szukacz/1.4.*|^T-H-U-N-D-E-R-S-T-O-N-E.*|^Tailrank.*|^tAkeOut.*|^Talkro|^TAMU_CRAWLER.*|^TapuzBot.*|^Tarantula.*|^targetblaster.com.*|^TargetYourNews.com|^TAUSDataBot.*|^taxinomiabot.*|^TeamSoft|^Tecomi|^TeezirBot.*|^Teleport.*|^Teleport|^Teleport|^Teleport|^Teleport|^Teleport|^Teleport|^Teleport|^TeleportPro.*|^Telesoft.*|^Teradex|^TERAGRAM_CRAWLER.*|^TerrawizBot.*|^TestBot.*|^testbot.*|^testBOT.*|^testing|^TextBot.*|^thatrobotsite.com.*|^The|^The|^The.Intraformant.*|^TheNomad.*|^Theophrastus.*|^theusefulbot.*|^TheUsefulbot_.*|^ThumbBot.*|^Thumbnail.CZ|^thumbshots-de-bot.*|^tigerbot.*|^TightTwatBot.*|^TinEye.*|^Titan.*|^TITAN.*|^to-dress_ru_bot_.*|^to-night-Bot.*|^toCrawl/UrlDispatcher.*|^Topicalizer.*|^topicblogs.*|^Toplistbot.*|^TopServer|^topyx-crawler.*|^Touche.*|^TourlentaScanner.*|^TPSystem.*|^TRAAZI.*|^TranSGeniKBot.*|^travel-search.*|^TravelBot.*|^TravelLazerBot.*|^Treezy.*|^TREX.*|^TridentSpider.*|^Trovator.*|^True_Robot.*|^tScholarsBot.*|^TSM|^TsWebBot.*|^TulipChain.*|^turingos.*|^TurnitinBot.*|^TurnitinBot/1.5.*|^TutorGigBot.*|^TweetedTimes|^TweetmemeBot.*|^TwengaBot.*|^TwengaBot-Discover.*|^Twiceler.*|^Twikle.*|^twinuffbot.*|^Twisted|^Twitturls.*|^Twitturly|^TygoBot.*|^TygoProwler.*|^Typhoeus.*|^U.S.|^uberbot.*|^ucb-nutch.*|^UdmSearch.*|^UFAM-crawler-.*|^Ultraseek.*|^UnChaos.*|^unchaos_crawler_.*|^UnisterBot.*|^Unitek|^UniversalSearch.*|^UnwindFetchor.*|^UofTDB_experiment.*|^updated.*|^URL|^url_gather.*|^URL-Checker.*|^URLAppendBot.*|^URLBlaze.*|^urlchecker.*|^urlck/1.2.3.*|^UrlDispatcher.*|^URLSpiderPro.*|^URLy|^URLy.Warning.*|^USAF|^usasearch.*|^USS-Cosmix.*|^USyd-NLP-Spider.*|^Vacobot.*|^Vacuum.*|^VadixBot.*|^Vagabondo.*|^Validator.*|^Valkyrie/1.0|^vBSEO.*|^VCI.*|^VCI|^VerbstarBot.*|^VeriCiteCrawler/Nutch-2.2.1|^Verifactrola.*|^Verity-URL-Gateway.*|^Vermut.*|^vermut.*|^versus|^versus.integis.ch.*|^viasarchivinginformation.html.*|^VIP.*|^VIPr.*|^virus_detector.*|^virus-detector.*|^VisBot.*|^Vishal|^VisWeb.*|^Vital|^vlad.*|^vlsearch.*|^VMBot.*|^VocusBot.*|^VoidEYE.*|^VoilaBot.*|^Vortex.*|^voyager-hc.*|^voyager-partner-deep.*|^voyager.*|^VSE.*|^vspider.*|^W3C_Unicorn.*|^W3C-WebCon.*|^w3m.*|^w3search.*|^wacbot.*|^wastrix.*|^Water|^Water|^WatzBot.*|^wauuu|^Wavefire.*|^Waypath.*|^Wazzup.*|^Wazzup1.0.4800.*|^wbdbot.*|^Web|^web|^Web|^Web|^Web|^Web|^Web|^Web|^web-agent.*|^Web-Sniffer.*|^Web.Image.Collector.*|^WebaltBot.*|^WebAuto.*|^WebAuto/3.40.*|^WebBandit.*|^webbandit.*|^WebBandit/3.50.*|^WebBOT.*|^webbot.*|^WebBot.*|^webbul-bot.*|^WebCapture.*|^WebCapture|^webcheck|^Webclipping.com.*|^webcollage.*|^WebCopier.*|^WebCopier|^WebCopier|^WebCopier|^WebCopier|^WebCopier|^WebCopier|^WebCopier|^WebCopier|^WebCopier|^WebCopy.*|^WebCorp.*|^webcrawl.net.*|^WebCrawler.*|^webcrawler.*|^WebCrawler/3.0|^WebDownloader|^Webdup.*|^WebEMailExtrac.*|^WebEnhancer.*|^WebFetch.*|^webfetch.*|^WebFetcher/0.8,.*|^WebGather.*|^WebGo|^webGobbler.*|^WebImages.*|^Webinator-search2.fasthealth.com.*|^Webinator-WBI.*|^WebIndex.*|^WebIndexer.*|^weblayers/0.0.*|^WebLeacher.*|^WeblexBot.*|^WebLinker/0.0|^webLyzard.*|^WebmasterCoffee.*|^WebmasterWorld|^WebmasterWorldForumBot.*|^WebMiner.*|^WebMoose/0.0.0000.*|^WeBot.*|^WebPix.*|^WebReaper.*|^WebRipper.*|^WebSauger.*|^WebSauger|^WebSauger|^WebSauger|^Webscan.*|^websearchbench.*|^WebSite.*|^Website|^Website|^Website|^Website|^Website.Quester.*|^websitemirror.*|^WebSpear.*|^websphinx.test.*|^WebSpider.*|^Webster.*|^Webster|^Webster.Pro.*|^WebStripper.*|^WebStripper/2.03.*|^WebStripper/2.10.*|^WebStripper/2.12.*|^WebStripper/2.13.*|^WebStripper/2.15.*|^WebStripper/2.16.*|^WebStripper/2.19.*|^WebTrafficExpress.*|^WebTrends|^WebVac.*|^webwalk.*|^WebWalker.*|^WebWalker/1.10.*|^WebWasher.*|^Webwasher.*|^WebWatch.*|^WebWhacker.*|^WebXM.*|^WebZIP.*|^Weddings.info|^wenbin/search.*|^WEP|^WEPA.*|^WeRelateBot.*|^Wget.*|^wget.*|^Wget/1.4.0.*|^Wget/1.5.2.*|^Wget/1.5.3.*|^Wget/1.6.*|^Wget/1.7.*|^Wget/1.8.*|^Wget/1.8.1.*|^Wget/1.8.1+cvs.*|^Wget/1.8.2.*|^Wget/1.9-beta.*|^Whacker.*|^Whirlpool|^WhoWhere|^Widow.*|^WikiaBot.*|^Wikio.*|^wikiwix-bot-.*|^WinHTTP|^WinHttp.WinHttpRequest..*|^WIRE.*|^wired-digital-newsbot/1.5.*|^WISEbot.*|^WISENutbot.*|^wish-la.*|^wish-project.*|^wisponbot.*|^WMCAI-robot.*|^wminer.*|^WMSBot.*|^woriobot.*|^worldshop.*|^WorQmada.*|^Wotbox.*|^wume_crawler.*|^WWW|^WWW-Collector-E.*|^WWW-Mechanize.*|^WWWOFFLE.*|^wwwrobot.*|^wwwster.*|^WWWWanderer|^wwwxref.*|^Wysigot.*|^X-clawler.*|^X-crawler.*|^Xaldon.*|^Xaldon|^Xaldon|^Xaldon_WebSpider.*|^Xenu.*|^Xenu|^Xenu|^Xerka|^Xerka|^XGET/0.7.*|^xirq.*|^XmarksFetch.*|^xqrobot.*|^Y!J-BRI.*|^Y!J-BRJ/YATS|^Y!J-BRW.*|^Y!J-BSC.*|^Y!J-PSC.*|^Y!J-SRD.*|^Y!J.*|^Y!TunnelPro.*|^yacy.net.*|^yacybot.*|^Yandex.*|^YandexBot.*|^YandexSomething.*|^Yanga|^yarienavoir.net.*|^Yasaklibot.*|^yBot.*|^YebolBot.*|^yellowJacket.*|^yes.*|^YesupBot.*|^Yeti.*|^YioopBot.*|^yolinkBot.*|^yoogliFetchAgent.*|^Yoono.*|^yoono.*|^Yoriwa.*|^YottaCars_Bot.*|^you-dir.*|^Z-Add|^zagrebin.*|^Zao.*|^zedzo.digest.*|^zedzo.validate.*|^zermelo.*|^Zeus.*|^Zeus|^Zeus|^Zeus|^Zeus|^Zeus|^Zeus|^Zeus|^Zeus|^Zeus|^Zeus|^Zeus|^Zeus|^Zeus|^Zeus|^Zeus|^Zeus|^Zeus|^Zeus|^Zeus|^Zeus|^Zeus|^Zeus|^Zeus|^zibber-v.*|^zimeno.*|^Zing-BottaBot.*|^ZipppBot.*|^ZoomSpider.*|^Zotag|^ZuiBot.*|^ZumBot.*|^Zyborg.*|^ZyBorg.*|^Zyte.*`,
    "i"
  );

  if (/(AhrefsBot|AhrefsSiteAudit)/i.test(ua)) {
    setResponseStatus(event, 403, "Forbidden");
    setHeader(event, "Cache-Control", "private, no-store, max-age=0");
    setHeader(event, "Content-Type", "text/plain; charset=utf-8");
    return "Forbidden";
  }

  if (BLOCK_RE.test(ua)) {
    // 403 и короткий текст — этого достаточно
    setResponseStatus(event, 403, "Forbidden");
    setHeader(event, "Cache-Control", "private, no-store, max-age=0");
    setHeader(event, "Content-Type", "text/plain; charset=utf-8");
    return "Forbidden";
  }
});
